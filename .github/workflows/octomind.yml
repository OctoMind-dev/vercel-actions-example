on:
  deployment_status

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - run: echo "${{ github.event.deployment_status.deployment_url }} ${{ github.deployment.payload }} ${{ github.issue.number }} ${{ github.pull_request.number }} ${{ github.number }}"

  octomind:
    if: ${{ github.event.deployment_status.state }} == 'success'
    name: ğŸš€ trigger octomind e2e tests ğŸš€
    runs-on: ubuntu-latest
    steps:
      - uses: OctoMind-dev/automagically-action-execute@v1
        with:
          url: ${{ github.event.deployment_status.target_url }}
          token: ${{ secrets.AUTOMAGICALLY_TOKEN }}